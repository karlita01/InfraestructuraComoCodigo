<?xml version="1.0" ?>
<testsuites disabled="0" errors="0" failures="70" tests="172" time="0.0">
	<testsuite disabled="0" errors="0" failures="70" name="terraform scan" skipped="0" tests="172" time="0">
		<properties>
			<property name="directory" value="['./terraform']"/>
			<property name="add_check" value="False"/>
			<property name="list" value="False"/>
			<property name="output" value="['junitxml']"/>
			<property name="output_file_path" value="results.xml"/>
			<property name="output_bc_ids" value="False"/>
			<property name="include_all_checkov_policies" value="True"/>
			<property name="quiet" value="False"/>
			<property name="compact" value="False"/>
			<property name="framework" value="['all']"/>
			<property name="skip_framework" value="[]"/>
			<property name="run_all_external_checks" value="False"/>
			<property name="soft_fail" value="False"/>
			<property name="skip_results_upload" value="False"/>
			<property name="repo_id" value="cli_repo/terraform"/>
			<property name="branch" value="master"/>
			<property name="skip_download" value="False"/>
			<property name="use_enforcement_rules" value="False"/>
			<property name="external_modules_download_path" value=".external_modules"/>
			<property name="evaluate_variables" value="True"/>
			<property name="no_cert_verify" value="False"/>
			<property name="create_baseline" value="False"/>
			<property name="output_baseline_as_skipped" value="False"/>
			<property name="secrets_scan_file_type" value="[]"/>
			<property name="enable_secret_scan_all_files" value="False"/>
			<property name="block_list_secret_scan" value="[]"/>
			<property name="summary_position" value="top"/>
			<property name="skip_resources_without_violations" value="False"/>
			<property name="deep_analysis" value="False"/>
			<property name="no_fail_on_crash" value="False"/>
			<property name="mask" value="defaultdict(&lt;class 'set'&gt;, {})"/>
			<property name="scan_secrets_history" value="False"/>
			<property name="secrets_history_timeout" value="12h"/>
			<property name="custom_tool_name" value="Checkov"/>
		</properties>
		<testcase name="[NONE][CKV_AWS_237] Ensure Create before destroy for API Gateway" classname="\apigateway.tf.aws_api_gateway_rest_api.productos_api" file="\apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_158] Ensure that CloudWatch Log Group is encrypted by KMS" classname="\apigateway.tf.aws_cloudwatch_log_group.api_gateway_logs" file="\apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_66] Ensure that CloudWatch Log Group specifies retention days" classname="\apigateway.tf.aws_cloudwatch_log_group.api_gateway_logs" file="\apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_76] Ensure API Gateway has Access Logging enabled" classname="\apigateway.tf.aws_api_gateway_stage.prod" file="\apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_59] Ensure there is no open access to back-end resources through API" classname="\apigateway.tf.aws_api_gateway_method.options[&quot;informes&quot;]" file="\apigateway.tf"/>
		<testcase name="[NONE][CKV2_AWS_70] Ensure API gateway method has authorization or API key set" classname="\apigateway.tf.aws_api_gateway_method.method" file="\apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_301] Ensure that AWS Lambda function is not publicly accessible" classname="\apigateway.tf.aws_lambda_permission.api_gateway_permissions[&quot;informes&quot;]" file="\apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_364] Ensure that AWS Lambda function permissions delegated to AWS services are limited by SourceArn or SourceAccount" classname="\apigateway.tf.aws_lambda_permission.api_gateway_permissions[&quot;informes&quot;]" file="\apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_59] Ensure there is no open access to back-end resources through API" classname="\apigateway.tf.aws_api_gateway_method.options[&quot;pedidos&quot;]" file="\apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_59] Ensure there is no open access to back-end resources through API" classname="\apigateway.tf.aws_api_gateway_method.options[&quot;productos&quot;]" file="\apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_301] Ensure that AWS Lambda function is not publicly accessible" classname="\apigateway.tf.aws_lambda_permission.api_gateway_permissions[&quot;pedidos&quot;]" file="\apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_364] Ensure that AWS Lambda function permissions delegated to AWS services are limited by SourceArn or SourceAccount" classname="\apigateway.tf.aws_lambda_permission.api_gateway_permissions[&quot;pedidos&quot;]" file="\apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_301] Ensure that AWS Lambda function is not publicly accessible" classname="\apigateway.tf.aws_lambda_permission.api_gateway_permissions[&quot;productos&quot;]" file="\apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_364] Ensure that AWS Lambda function permissions delegated to AWS services are limited by SourceArn or SourceAccount" classname="\apigateway.tf.aws_lambda_permission.api_gateway_permissions[&quot;productos&quot;]" file="\apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_305] Ensure CloudFront distribution has a default root object configured" classname="\cloudfront.tf.aws_cloudfront_distribution.frontend_cdn" file="\cloudfront.tf"/>
		<testcase name="[NONE][CKV_AWS_216] Ensure CloudFront distribution is enabled" classname="\cloudfront.tf.aws_cloudfront_distribution.frontend_cdn" file="\cloudfront.tf"/>
		<testcase name="[NONE][CKV_AWS_34] Ensure CloudFront distribution ViewerProtocolPolicy is set to HTTPS" classname="\cloudfront.tf.aws_cloudfront_distribution.frontend_cdn" file="\cloudfront.tf"/>
		<testcase name="[NONE][CKV_AWS_301] Ensure that AWS Lambda function is not publicly accessible" classname="\cloudwatch_trigger.tf.aws_lambda_permission.permitir_cloudwatch" file="\cloudwatch_trigger.tf"/>
		<testcase name="[NONE][CKV_AWS_364] Ensure that AWS Lambda function permissions delegated to AWS services are limited by SourceArn or SourceAccount" classname="\cloudwatch_trigger.tf.aws_lambda_permission.permitir_cloudwatch" file="\cloudwatch_trigger.tf"/>
		<testcase name="[NONE][CKV_AWS_227] Ensure KMS key is enabled" classname="\cloudwatch_trigger.tf.aws_kms_key.logs_key" file="\cloudwatch_trigger.tf"/>
		<testcase name="[NONE][CKV_AWS_33] Ensure KMS key policy does not contain wildcard (*) principal" classname="\cloudwatch_trigger.tf.aws_kms_key.logs_key" file="\cloudwatch_trigger.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="\iam.tf.aws_iam_role.apigateway_cloudwatch_role" file="\iam.tf"/>
		<testcase name="[NONE][CKV_AWS_61] Ensure AWS IAM policy does not allow assume role permission across all services" classname="\iam.tf.aws_iam_role.apigateway_cloudwatch_role" file="\iam.tf"/>
		<testcase name="[NONE][CKV_AWS_60] Ensure IAM role allows only specific services or principals to assume it" classname="\iam.tf.aws_iam_role.apigateway_cloudwatch_role" file="\iam.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="\iam.tf.aws_iam_role_policy_attachment.apigateway_cloudwatch_logs_policy" file="\iam.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="\iam.tf.aws_iam_role.lambda_rds_role" file="\iam.tf"/>
		<testcase name="[NONE][CKV_AWS_61] Ensure AWS IAM policy does not allow assume role permission across all services" classname="\iam.tf.aws_iam_role.lambda_rds_role" file="\iam.tf"/>
		<testcase name="[NONE][CKV_AWS_60] Ensure IAM role allows only specific services or principals to assume it" classname="\iam.tf.aws_iam_role.lambda_rds_role" file="\iam.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="\iam.tf.aws_iam_role.lambda_role" file="\iam.tf"/>
		<testcase name="[NONE][CKV_AWS_61] Ensure AWS IAM policy does not allow assume role permission across all services" classname="\iam.tf.aws_iam_role.lambda_role" file="\iam.tf"/>
		<testcase name="[NONE][CKV_AWS_60] Ensure IAM role allows only specific services or principals to assume it" classname="\iam.tf.aws_iam_role.lambda_role" file="\iam.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="\iam.tf.aws_iam_role_policy_attachment.lambda_basic_execution" file="\iam.tf"/>
		<testcase name="[NONE][CKV_AWS_62] Ensure IAM policies that allow full &quot;*-*&quot; administrative privileges are not created" classname="\iam.tf.aws_iam_policy.lambda_rds_access" file="\iam.tf"/>
		<testcase name="[NONE][CKV_AWS_288] Ensure IAM policies does not allow data exfiltration" classname="\iam.tf.aws_iam_policy.lambda_rds_access" file="\iam.tf"/>
		<testcase name="[NONE][CKV_AWS_286] Ensure IAM policies does not allow privilege escalation" classname="\iam.tf.aws_iam_policy.lambda_rds_access" file="\iam.tf"/>
		<testcase name="[NONE][CKV_AWS_63] Ensure no IAM policies documents allow &quot;*&quot; as a statement's actions" classname="\iam.tf.aws_iam_policy.lambda_rds_access" file="\iam.tf"/>
		<testcase name="[NONE][CKV_AWS_290] Ensure IAM policies does not allow write access without constraints" classname="\iam.tf.aws_iam_policy.lambda_rds_access" file="\iam.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="\iam.tf.aws_iam_role_policy_attachment.lambda_rds_access_attach" file="\iam.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="\iam.tf.aws_iam_role_policy_attachment.lambda_vpc_access" file="\iam.tf"/>
		<testcase name="[NONE][CKV_AWS_363] Ensure Lambda Runtime is not deprecated" classname="\lambda.tf.aws_lambda_function.generar_informes" file="\lambda.tf"/>
		<testcase name="[NONE][CKV_AWS_45] Ensure no hard-coded secrets exist in lambda environment" classname="\lambda.tf.aws_lambda_function.generar_informes" file="\lambda.tf"/>
		<testcase name="[NONE][CKV_AWS_117] Ensure that AWS Lambda function is configured inside a VPC" classname="\lambda.tf.aws_lambda_function.generar_informes" file="\lambda.tf"/>
		<testcase name="[NONE][CKV_AWS_363] Ensure Lambda Runtime is not deprecated" classname="\lambda.tf.aws_lambda_function.gestionar_pedidos" file="\lambda.tf"/>
		<testcase name="[NONE][CKV_AWS_45] Ensure no hard-coded secrets exist in lambda environment" classname="\lambda.tf.aws_lambda_function.gestionar_pedidos" file="\lambda.tf"/>
		<testcase name="[NONE][CKV_AWS_117] Ensure that AWS Lambda function is configured inside a VPC" classname="\lambda.tf.aws_lambda_function.gestionar_pedidos" file="\lambda.tf"/>
		<testcase name="[NONE][CKV_AWS_363] Ensure Lambda Runtime is not deprecated" classname="\lambda.tf.aws_lambda_function.init_db" file="\lambda.tf"/>
		<testcase name="[NONE][CKV_AWS_45] Ensure no hard-coded secrets exist in lambda environment" classname="\lambda.tf.aws_lambda_function.init_db" file="\lambda.tf"/>
		<testcase name="[NONE][CKV_AWS_117] Ensure that AWS Lambda function is configured inside a VPC" classname="\lambda.tf.aws_lambda_function.init_db" file="\lambda.tf"/>
		<testcase name="[NONE][CKV_AWS_274] Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy" classname="\lambda.tf.aws_iam_role.lambda_exec_role" file="\lambda.tf"/>
		<testcase name="[NONE][CKV_AWS_61] Ensure AWS IAM policy does not allow assume role permission across all services" classname="\lambda.tf.aws_iam_role.lambda_exec_role" file="\lambda.tf"/>
		<testcase name="[NONE][CKV_AWS_60] Ensure IAM role allows only specific services or principals to assume it" classname="\lambda.tf.aws_iam_role.lambda_exec_role" file="\lambda.tf"/>
		<testcase name="[NONE][CKV_AWS_24] Ensure no security groups allow ingress from 0.0.0.0:0 to port 22" classname="\lambda.tf.aws_security_group.lambda_sg" file="\lambda.tf"/>
		<testcase name="[NONE][CKV_AWS_25] Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389" classname="\lambda.tf.aws_security_group.lambda_sg" file="\lambda.tf"/>
		<testcase name="[NONE][CKV_AWS_260] Ensure no security groups allow ingress from 0.0.0.0:0 to port 80" classname="\lambda.tf.aws_security_group.lambda_sg" file="\lambda.tf"/>
		<testcase name="[NONE][CKV_AWS_277] Ensure no security groups allow ingress from 0.0.0.0:0 to port -1" classname="\lambda.tf.aws_security_group.lambda_sg" file="\lambda.tf"/>
		<testcase name="[NONE][CKV_AWS_24] Ensure no security groups allow ingress from 0.0.0.0:0 to port 22" classname="\lambda.tf.aws_security_group_rule.allow_lambda_access_rds" file="\lambda.tf"/>
		<testcase name="[NONE][CKV_AWS_25] Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389" classname="\lambda.tf.aws_security_group_rule.allow_lambda_access_rds" file="\lambda.tf"/>
		<testcase name="[NONE][CKV_AWS_260] Ensure no security groups allow ingress from 0.0.0.0:0 to port 80" classname="\lambda.tf.aws_security_group_rule.allow_lambda_access_rds" file="\lambda.tf"/>
		<testcase name="[NONE][CKV_AWS_277] Ensure no security groups allow ingress from 0.0.0.0:0 to port -1" classname="\lambda.tf.aws_security_group_rule.allow_lambda_access_rds" file="\lambda.tf"/>
		<testcase name="[NONE][CKV_AWS_363] Ensure Lambda Runtime is not deprecated" classname="\lambda.tf.aws_lambda_function.guardar_producto" file="\lambda.tf"/>
		<testcase name="[NONE][CKV_AWS_45] Ensure no hard-coded secrets exist in lambda environment" classname="\lambda.tf.aws_lambda_function.guardar_producto" file="\lambda.tf"/>
		<testcase name="[NONE][CKV_AWS_117] Ensure that AWS Lambda function is configured inside a VPC" classname="\lambda.tf.aws_lambda_function.guardar_producto" file="\lambda.tf"/>
		<testcase name="[NONE][CKV_AWS_41] Ensure no hard coded AWS access key and secret key exists in provider" classname="\main.tf.aws.default" file="\main.tf"/>
		<testcase name="[NONE][CKV_AWS_133] Ensure that RDS instances has backup policy" classname="\rds.tf.aws_db_instance.productos_db" file="\rds.tf"/>
		<testcase name="[NONE][CKV_AWS_211] Ensure RDS uses a modern CaCert" classname="\rds.tf.aws_db_instance.productos_db" file="\rds.tf"/>
		<testcase name="[NONE][CKV_AWS_354] Ensure RDS Performance Insights are encrypted using KMS CMKs" classname="\rds.tf.aws_db_instance.productos_db" file="\rds.tf"/>
		<testcase name="[NONE][CKV_AWS_17] Ensure all data stored in RDS is not publicly accessible" classname="\rds.tf.aws_db_instance.productos_db" file="\rds.tf"/>
		<testcase name="[NONE][CKV_AWS_388] Ensure AWS Aurora PostgreSQL is not exposed to local file read vulnerability" classname="\rds.tf.aws_db_instance.productos_db" file="\rds.tf"/>
		<testcase name="[NONE][CKV_AWS_24] Ensure no security groups allow ingress from 0.0.0.0:0 to port 22" classname="\rds.tf.aws_security_group.rds_sg" file="\rds.tf"/>
		<testcase name="[NONE][CKV_AWS_25] Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389" classname="\rds.tf.aws_security_group.rds_sg" file="\rds.tf"/>
		<testcase name="[NONE][CKV_AWS_260] Ensure no security groups allow ingress from 0.0.0.0:0 to port 80" classname="\rds.tf.aws_security_group.rds_sg" file="\rds.tf"/>
		<testcase name="[NONE][CKV_AWS_277] Ensure no security groups allow ingress from 0.0.0.0:0 to port -1" classname="\rds.tf.aws_security_group.rds_sg" file="\rds.tf"/>
		<testcase name="[NONE][CKV_AWS_93] Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)" classname="\s3.tf.aws_s3_bucket.frontend" file="\s3.tf"/>
		<testcase name="[NONE][CKV_AWS_93] Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)" classname="\s3.tf.aws_s3_bucket_policy.allow_public_read" file="\s3.tf"/>
		<testcase name="[NONE][CKV_AWS_130] Ensure VPC subnets do not assign public IP by default" classname="\vpc.tf.aws_subnet.main" file="\vpc.tf"/>
		<testcase name="[NONE][CKV_AWS_130] Ensure VPC subnets do not assign public IP by default" classname="\vpc.tf.aws_subnet.secondary" file="\vpc.tf"/>
		<testcase name="[NONE][CKV2_AWS_77] Ensure AWS API Gateway Rest API attached WAFv2 WebACL is configured with AMR for Log4j Vulnerability" classname="\apigateway.tf.aws_api_gateway_stage.prod" file="\apigateway.tf"/>
		<testcase name="[NONE][CKV2_AWS_35] AWS NAT Gateways should be utilized for the default route" classname="\vpc.tf.aws_route_table.public_rt" file="\vpc.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="\iam.tf.aws_iam_role.apigateway_cloudwatch_role" file="\iam.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="\iam.tf.aws_iam_role_policy_attachment.apigateway_cloudwatch_logs_policy" file="\iam.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="\iam.tf.aws_iam_role.lambda_rds_role" file="\iam.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="\iam.tf.aws_iam_role.lambda_role" file="\iam.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="\iam.tf.aws_iam_role_policy_attachment.lambda_basic_execution" file="\iam.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="\iam.tf.aws_iam_role_policy_attachment.lambda_vpc_access" file="\iam.tf"/>
		<testcase name="[NONE][CKV2_AWS_56] Ensure AWS Managed IAMFullAccess IAM policy is not used." classname="\lambda.tf.aws_iam_role.lambda_exec_role" file="\lambda.tf"/>
		<testcase name="[NONE][CKV2_AWS_75] Ensure no open CORS policy" classname="\lambda.tf.aws_lambda_function.generar_informes" file="\lambda.tf"/>
		<testcase name="[NONE][CKV2_AWS_75] Ensure no open CORS policy" classname="\lambda.tf.aws_lambda_function.gestionar_pedidos" file="\lambda.tf"/>
		<testcase name="[NONE][CKV2_AWS_75] Ensure no open CORS policy" classname="\lambda.tf.aws_lambda_function.init_db" file="\lambda.tf"/>
		<testcase name="[NONE][CKV2_AWS_75] Ensure no open CORS policy" classname="\lambda.tf.aws_lambda_function.guardar_producto" file="\lambda.tf"/>
		<testcase name="[NONE][CKV2_AWS_69] Ensure AWS RDS database instance configured with encryption in transit" classname="\rds.tf.aws_db_instance.productos_db" file="\rds.tf"/>
		<testcase name="[NONE][CKV2_AWS_54] Ensure AWS CloudFront distribution is using secure SSL protocols for HTTPS communication" classname="\cloudfront.tf.aws_cloudfront_distribution.frontend_cdn" file="\cloudfront.tf"/>
		<testcase name="[NONE][CKV2_AWS_5] Ensure that Security Groups are attached to another resource" classname="\rds.tf.aws_security_group.rds_sg" file="\rds.tf"/>
		<testcase name="[NONE][CKV2_AWS_5] Ensure that Security Groups are attached to another resource" classname="\lambda.tf.aws_security_group.lambda_sg" file="\lambda.tf"/>
		<testcase name="[NONE][CKV2_AWS_44] Ensure AWS route table with VPC peering does not contain routes overly permissive to all traffic" classname="\vpc.tf.aws_route_table.public_rt" file="\vpc.tf"/>
		<testcase name="[NONE][CKV_AWS_20] S3 Bucket has an ACL defined which allows public READ access." classname="\s3.tf.aws_s3_bucket.frontend" file="\s3.tf"/>
		<testcase name="[NONE][CKV_AWS_57] S3 Bucket has an ACL defined which allows public WRITE access." classname="\s3.tf.aws_s3_bucket.frontend" file="\s3.tf"/>
		<testcase name="[NONE][CKV2_AWS_40] Ensure AWS IAM policy does not allow full IAM privileges" classname="\iam.tf.aws_iam_policy.lambda_rds_access" file="\iam.tf"/>
		<testcase name="[NONE][CKV2_AWS_46] Ensure AWS CloudFront Distribution with S3 have Origin Access set to enabled" classname="\cloudfront.tf.aws_cloudfront_distribution.frontend_cdn" file="\cloudfront.tf"/>
		<testcase name="[NONE][CKV2_AWS_53] Ensure AWS API gateway request is validated" classname="\apigateway.tf.aws_api_gateway_method.options[&quot;informes&quot;]" file="\apigateway.tf"/>
		<testcase name="[NONE][CKV2_AWS_53] Ensure AWS API gateway request is validated" classname="\apigateway.tf.aws_api_gateway_method.options[&quot;pedidos&quot;]" file="\apigateway.tf"/>
		<testcase name="[NONE][CKV2_AWS_53] Ensure AWS API gateway request is validated" classname="\apigateway.tf.aws_api_gateway_method.options[&quot;productos&quot;]" file="\apigateway.tf"/>
		<testcase name="[NONE][CKV_AWS_19] Ensure all data stored in the S3 bucket is securely encrypted at rest" classname="\s3.tf.aws_s3_bucket.frontend" file="\s3.tf"/>
		<testcase name="[NONE][CKV_AWS_338] Ensure CloudWatch log groups retains logs for at least 1 year" classname="\apigateway.tf.aws_cloudwatch_log_group.api_gateway_logs" file="\apigateway.tf">
			<failure type="failure" message="Ensure CloudWatch log groups retains logs for at least 1 year">
Resource: aws_cloudwatch_log_group.api_gateway_logs
File: \apigateway.tf: 13-17
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-338

		13 | resource &quot;aws_cloudwatch_log_group&quot; &quot;api_gateway_logs&quot; {
		14 |   name              = &quot;/aws/api-gateway/productos-api&quot;
		15 |   retention_in_days = 7
		16 |   kms_key_id        = aws_kms_key.logs_key.arn
		17 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_120] Ensure API Gateway caching is enabled" classname="\apigateway.tf.aws_api_gateway_stage.prod" file="\apigateway.tf">
			<failure type="failure" message="Ensure API Gateway caching is enabled">
Resource: aws_api_gateway_stage.prod
File: \apigateway.tf: 19-39
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-api-gateway-caching-is-enabled

		19 | resource &quot;aws_api_gateway_stage&quot; &quot;prod&quot; {
		20 |   deployment_id = aws_api_gateway_deployment.deploy.id
		21 |   rest_api_id   = aws_api_gateway_rest_api.productos_api.id
		22 |   stage_name    = &quot;prod&quot;
		23 | 
		24 |   access_log_settings {
		25 |     destination_arn = aws_cloudwatch_log_group.api_gateway_logs.arn
		26 |     format = jsonencode({
		27 |       requestId      = &quot;$context.requestId&quot;
		28 |       ip             = &quot;$context.identity.sourceIp&quot;
		29 |       caller         = &quot;$context.identity.caller&quot;
		30 |       user           = &quot;$context.identity.user&quot;
		31 |       requestTime    = &quot;$context.requestTime&quot;
		32 |       httpMethod     = &quot;$context.httpMethod&quot;
		33 |       resourcePath   = &quot;$context.resourcePath&quot;
		34 |       status         = &quot;$context.status&quot;
		35 |       protocol       = &quot;$context.protocol&quot;
		36 |       responseLength = &quot;$context.responseLength&quot;
		37 |     })
		38 |   }
		39 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_73] Ensure API Gateway has X-Ray Tracing enabled" classname="\apigateway.tf.aws_api_gateway_stage.prod" file="\apigateway.tf">
			<failure type="failure" message="Ensure API Gateway has X-Ray Tracing enabled">
Resource: aws_api_gateway_stage.prod
File: \apigateway.tf: 19-39
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-15

		19 | resource &quot;aws_api_gateway_stage&quot; &quot;prod&quot; {
		20 |   deployment_id = aws_api_gateway_deployment.deploy.id
		21 |   rest_api_id   = aws_api_gateway_rest_api.productos_api.id
		22 |   stage_name    = &quot;prod&quot;
		23 | 
		24 |   access_log_settings {
		25 |     destination_arn = aws_cloudwatch_log_group.api_gateway_logs.arn
		26 |     format = jsonencode({
		27 |       requestId      = &quot;$context.requestId&quot;
		28 |       ip             = &quot;$context.identity.sourceIp&quot;
		29 |       caller         = &quot;$context.identity.caller&quot;
		30 |       user           = &quot;$context.identity.user&quot;
		31 |       requestTime    = &quot;$context.requestTime&quot;
		32 |       httpMethod     = &quot;$context.httpMethod&quot;
		33 |       resourcePath   = &quot;$context.resourcePath&quot;
		34 |       status         = &quot;$context.status&quot;
		35 |       protocol       = &quot;$context.protocol&quot;
		36 |       responseLength = &quot;$context.responseLength&quot;
		37 |     })
		38 |   }
		39 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_59] Ensure there is no open access to back-end resources through API" classname="\apigateway.tf.aws_api_gateway_method.method" file="\apigateway.tf">
			<failure type="failure" message="Ensure there is no open access to back-end resources through API">
Resource: aws_api_gateway_method.method
File: \apigateway.tf: 128-134
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-6-api-gateway-authorizer-set

		128 | resource &quot;aws_api_gateway_method&quot; &quot;method&quot; {
		129 |   for_each    = { for k, v in local.resources : k =&gt; v if length(v.methods) &gt; 0 }
		130 |   rest_api_id = aws_api_gateway_rest_api.productos_api.id
		131 |   resource_id = aws_api_gateway_resource.resource[each.key].id
		132 |   http_method = each.value.methods[0]
		133 |   authorization = &quot;NONE&quot;
		134 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_217] Ensure Create before destroy for API deployments" classname="\apigateway.tf.aws_api_gateway_deployment.deploy" file="\apigateway.tf">
			<failure type="failure" message="Ensure Create before destroy for API deployments">
Resource: aws_api_gateway_deployment.deploy
File: \apigateway.tf: 178-187
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-api-deployments-enable-create-before-destroy

		178 | resource &quot;aws_api_gateway_deployment&quot; &quot;deploy&quot; {
		179 |   rest_api_id = aws_api_gateway_rest_api.productos_api.id
		180 | 
		181 |   depends_on = [
		182 |     aws_api_gateway_integration.lambda_integration,
		183 |     aws_api_gateway_integration_response.method,
		184 |     aws_api_gateway_integration.options,
		185 |     aws_api_gateway_integration_response.options
		186 |   ]
		187 | }</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_86] Ensure CloudFront distribution has Access Logging enabled" classname="\cloudfront.tf.aws_cloudfront_distribution.frontend_cdn" file="\cloudfront.tf">
			<failure type="failure" message="Ensure CloudFront distribution has Access Logging enabled">
Resource: aws_cloudfront_distribution.frontend_cdn
File: \cloudfront.tf: 1-40
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-20

		1  | resource &quot;aws_cloudfront_distribution&quot; &quot;frontend_cdn&quot; {
		2  |   origin {
		3  |     domain_name = aws_s3_bucket_website_configuration.frontend_website.website_endpoint
		4  |     origin_id   = &quot;frontendS3&quot;
		5  | 
		6  |     custom_origin_config {
		7  |       http_port              = 80
		8  |       https_port             = 443
		9  |       origin_protocol_policy = &quot;http-only&quot;
		10 |       origin_ssl_protocols   = [&quot;TLSv1.2&quot;]
		11 |     }
		12 |   }
		13 | 
		14 |   enabled             = true
		15 |   default_root_object = &quot;index.html&quot;
		16 | 
		17 |   default_cache_behavior {
		18 |     viewer_protocol_policy = &quot;redirect-to-https&quot;
		19 |     allowed_methods        = [&quot;GET&quot;, &quot;HEAD&quot;]
		20 |     cached_methods         = [&quot;GET&quot;, &quot;HEAD&quot;]
		21 | 
		22 |     target_origin_id = &quot;frontendS3&quot;
		23 |     forwarded_values {
		24 |       query_string = false
		25 |       cookies {
		26 |         forward = &quot;none&quot;
		27 |       }
		28 |     }
		29 |   }
		30 | 
		31 |   restrictions {
		32 |     geo_restriction {
		33 |       restriction_type = &quot;none&quot;
		34 |     }
		35 |   }
		36 | 
		37 |   viewer_certificate {
		38 |     cloudfront_default_certificate = true
		39 |   }
		40 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_310] Ensure CloudFront distributions should have origin failover configured" classname="\cloudfront.tf.aws_cloudfront_distribution.frontend_cdn" file="\cloudfront.tf">
			<failure type="failure" message="Ensure CloudFront distributions should have origin failover configured">
Resource: aws_cloudfront_distribution.frontend_cdn
File: \cloudfront.tf: 1-40
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-310

		1  | resource &quot;aws_cloudfront_distribution&quot; &quot;frontend_cdn&quot; {
		2  |   origin {
		3  |     domain_name = aws_s3_bucket_website_configuration.frontend_website.website_endpoint
		4  |     origin_id   = &quot;frontendS3&quot;
		5  | 
		6  |     custom_origin_config {
		7  |       http_port              = 80
		8  |       https_port             = 443
		9  |       origin_protocol_policy = &quot;http-only&quot;
		10 |       origin_ssl_protocols   = [&quot;TLSv1.2&quot;]
		11 |     }
		12 |   }
		13 | 
		14 |   enabled             = true
		15 |   default_root_object = &quot;index.html&quot;
		16 | 
		17 |   default_cache_behavior {
		18 |     viewer_protocol_policy = &quot;redirect-to-https&quot;
		19 |     allowed_methods        = [&quot;GET&quot;, &quot;HEAD&quot;]
		20 |     cached_methods         = [&quot;GET&quot;, &quot;HEAD&quot;]
		21 | 
		22 |     target_origin_id = &quot;frontendS3&quot;
		23 |     forwarded_values {
		24 |       query_string = false
		25 |       cookies {
		26 |         forward = &quot;none&quot;
		27 |       }
		28 |     }
		29 |   }
		30 | 
		31 |   restrictions {
		32 |     geo_restriction {
		33 |       restriction_type = &quot;none&quot;
		34 |     }
		35 |   }
		36 | 
		37 |   viewer_certificate {
		38 |     cloudfront_default_certificate = true
		39 |   }
		40 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_374] Ensure AWS CloudFront web distribution has geo restriction enabled" classname="\cloudfront.tf.aws_cloudfront_distribution.frontend_cdn" file="\cloudfront.tf">
			<failure type="failure" message="Ensure AWS CloudFront web distribution has geo restriction enabled">
Resource: aws_cloudfront_distribution.frontend_cdn
File: \cloudfront.tf: 1-40
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-374

		1  | resource &quot;aws_cloudfront_distribution&quot; &quot;frontend_cdn&quot; {
		2  |   origin {
		3  |     domain_name = aws_s3_bucket_website_configuration.frontend_website.website_endpoint
		4  |     origin_id   = &quot;frontendS3&quot;
		5  | 
		6  |     custom_origin_config {
		7  |       http_port              = 80
		8  |       https_port             = 443
		9  |       origin_protocol_policy = &quot;http-only&quot;
		10 |       origin_ssl_protocols   = [&quot;TLSv1.2&quot;]
		11 |     }
		12 |   }
		13 | 
		14 |   enabled             = true
		15 |   default_root_object = &quot;index.html&quot;
		16 | 
		17 |   default_cache_behavior {
		18 |     viewer_protocol_policy = &quot;redirect-to-https&quot;
		19 |     allowed_methods        = [&quot;GET&quot;, &quot;HEAD&quot;]
		20 |     cached_methods         = [&quot;GET&quot;, &quot;HEAD&quot;]
		21 | 
		22 |     target_origin_id = &quot;frontendS3&quot;
		23 |     forwarded_values {
		24 |       query_string = false
		25 |       cookies {
		26 |         forward = &quot;none&quot;
		27 |       }
		28 |     }
		29 |   }
		30 | 
		31 |   restrictions {
		32 |     geo_restriction {
		33 |       restriction_type = &quot;none&quot;
		34 |     }
		35 |   }
		36 | 
		37 |   viewer_certificate {
		38 |     cloudfront_default_certificate = true
		39 |   }
		40 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_174] Verify CloudFront Distribution Viewer Certificate is using TLS v1.2" classname="\cloudfront.tf.aws_cloudfront_distribution.frontend_cdn" file="\cloudfront.tf">
			<failure type="failure" message="Verify CloudFront Distribution Viewer Certificate is using TLS v1.2">
Resource: aws_cloudfront_distribution.frontend_cdn
File: \cloudfront.tf: 1-40
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-networking-63

		1  | resource &quot;aws_cloudfront_distribution&quot; &quot;frontend_cdn&quot; {
		2  |   origin {
		3  |     domain_name = aws_s3_bucket_website_configuration.frontend_website.website_endpoint
		4  |     origin_id   = &quot;frontendS3&quot;
		5  | 
		6  |     custom_origin_config {
		7  |       http_port              = 80
		8  |       https_port             = 443
		9  |       origin_protocol_policy = &quot;http-only&quot;
		10 |       origin_ssl_protocols   = [&quot;TLSv1.2&quot;]
		11 |     }
		12 |   }
		13 | 
		14 |   enabled             = true
		15 |   default_root_object = &quot;index.html&quot;
		16 | 
		17 |   default_cache_behavior {
		18 |     viewer_protocol_policy = &quot;redirect-to-https&quot;
		19 |     allowed_methods        = [&quot;GET&quot;, &quot;HEAD&quot;]
		20 |     cached_methods         = [&quot;GET&quot;, &quot;HEAD&quot;]
		21 | 
		22 |     target_origin_id = &quot;frontendS3&quot;
		23 |     forwarded_values {
		24 |       query_string = false
		25 |       cookies {
		26 |         forward = &quot;none&quot;
		27 |       }
		28 |     }
		29 |   }
		30 | 
		31 |   restrictions {
		32 |     geo_restriction {
		33 |       restriction_type = &quot;none&quot;
		34 |     }
		35 |   }
		36 | 
		37 |   viewer_certificate {
		38 |     cloudfront_default_certificate = true
		39 |   }
		40 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_68] CloudFront Distribution should have WAF enabled" classname="\cloudfront.tf.aws_cloudfront_distribution.frontend_cdn" file="\cloudfront.tf">
			<failure type="failure" message="CloudFront Distribution should have WAF enabled">
Resource: aws_cloudfront_distribution.frontend_cdn
File: \cloudfront.tf: 1-40
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-27

		1  | resource &quot;aws_cloudfront_distribution&quot; &quot;frontend_cdn&quot; {
		2  |   origin {
		3  |     domain_name = aws_s3_bucket_website_configuration.frontend_website.website_endpoint
		4  |     origin_id   = &quot;frontendS3&quot;
		5  | 
		6  |     custom_origin_config {
		7  |       http_port              = 80
		8  |       https_port             = 443
		9  |       origin_protocol_policy = &quot;http-only&quot;
		10 |       origin_ssl_protocols   = [&quot;TLSv1.2&quot;]
		11 |     }
		12 |   }
		13 | 
		14 |   enabled             = true
		15 |   default_root_object = &quot;index.html&quot;
		16 | 
		17 |   default_cache_behavior {
		18 |     viewer_protocol_policy = &quot;redirect-to-https&quot;
		19 |     allowed_methods        = [&quot;GET&quot;, &quot;HEAD&quot;]
		20 |     cached_methods         = [&quot;GET&quot;, &quot;HEAD&quot;]
		21 | 
		22 |     target_origin_id = &quot;frontendS3&quot;
		23 |     forwarded_values {
		24 |       query_string = false
		25 |       cookies {
		26 |         forward = &quot;none&quot;
		27 |       }
		28 |     }
		29 |   }
		30 | 
		31 |   restrictions {
		32 |     geo_restriction {
		33 |       restriction_type = &quot;none&quot;
		34 |     }
		35 |   }
		36 | 
		37 |   viewer_certificate {
		38 |     cloudfront_default_certificate = true
		39 |   }
		40 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_7] Ensure rotation for customer created CMKs is enabled" classname="\cloudwatch_trigger.tf.aws_kms_key.logs_key" file="\cloudwatch_trigger.tf">
			<failure type="failure" message="Ensure rotation for customer created CMKs is enabled">
Resource: aws_kms_key.logs_key
File: \cloudwatch_trigger.tf: 20-22
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-8

		20 | resource &quot;aws_kms_key&quot; &quot;logs_key&quot; {
		21 |   description = &quot;KMS key for CloudWatch log group encryption&quot;
		22 | }</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_287] Ensure IAM policies does not allow credentials exposure" classname="\iam.tf.aws_iam_policy.lambda_rds_access" file="\iam.tf">
			<failure type="failure" message="Ensure IAM policies does not allow credentials exposure">
Resource: aws_iam_policy.lambda_rds_access
File: \iam.tf: 62-78
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-287

		62 | resource &quot;aws_iam_policy&quot; &quot;lambda_rds_access&quot; {
		63 |   name        = &quot;lambda-rds-access&quot;
		64 |   description = &quot;Permite acceso a la base de datos RDS&quot;
		65 |   policy      = jsonencode({
		66 |     Version = &quot;2012-10-17&quot;,
		67 |     Statement = [
		68 |       {
		69 |         Effect = &quot;Allow&quot;,
		70 |         Action = [
		71 |           &quot;rds:DescribeDBInstances&quot;,
		72 |           &quot;rds-db:connect&quot;
		73 |         ],
		74 |         Resource = &quot;*&quot;
		75 |       }
		76 |     ]
		77 |   })
		78 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_289] Ensure IAM policies does not allow permissions management / resource exposure without constraints" classname="\iam.tf.aws_iam_policy.lambda_rds_access" file="\iam.tf">
			<failure type="failure" message="Ensure IAM policies does not allow permissions management / resource exposure without constraints">
Resource: aws_iam_policy.lambda_rds_access
File: \iam.tf: 62-78
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-289

		62 | resource &quot;aws_iam_policy&quot; &quot;lambda_rds_access&quot; {
		63 |   name        = &quot;lambda-rds-access&quot;
		64 |   description = &quot;Permite acceso a la base de datos RDS&quot;
		65 |   policy      = jsonencode({
		66 |     Version = &quot;2012-10-17&quot;,
		67 |     Statement = [
		68 |       {
		69 |         Effect = &quot;Allow&quot;,
		70 |         Action = [
		71 |           &quot;rds:DescribeDBInstances&quot;,
		72 |           &quot;rds-db:connect&quot;
		73 |         ],
		74 |         Resource = &quot;*&quot;
		75 |       }
		76 |     ]
		77 |   })
		78 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_355] Ensure no IAM policies documents allow &quot;*&quot; as a statement's resource for restrictable actions" classname="\iam.tf.aws_iam_policy.lambda_rds_access" file="\iam.tf">
			<failure type="failure" message="Ensure no IAM policies documents allow &quot;*&quot; as a statement's resource for restrictable actions">
Resource: aws_iam_policy.lambda_rds_access
File: \iam.tf: 62-78
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-355

		62 | resource &quot;aws_iam_policy&quot; &quot;lambda_rds_access&quot; {
		63 |   name        = &quot;lambda-rds-access&quot;
		64 |   description = &quot;Permite acceso a la base de datos RDS&quot;
		65 |   policy      = jsonencode({
		66 |     Version = &quot;2012-10-17&quot;,
		67 |     Statement = [
		68 |       {
		69 |         Effect = &quot;Allow&quot;,
		70 |         Action = [
		71 |           &quot;rds:DescribeDBInstances&quot;,
		72 |           &quot;rds-db:connect&quot;
		73 |         ],
		74 |         Resource = &quot;*&quot;
		75 |       }
		76 |     ]
		77 |   })
		78 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_272] Ensure AWS Lambda function is configured to validate code-signing" classname="\lambda.tf.aws_lambda_function.generar_informes" file="\lambda.tf">
			<failure type="failure" message="Ensure AWS Lambda function is configured to validate code-signing">
Resource: aws_lambda_function.generar_informes
File: \lambda.tf: 9-25
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-272

		9  | resource &quot;aws_lambda_function&quot; &quot;generar_informes&quot; {
		10 |   function_name    = &quot;generar_informes&quot;
		11 |   role             = aws_iam_role.lambda_rds_role.arn
		12 |   handler          = &quot;index.handler&quot;
		13 |   runtime          = &quot;nodejs18.x&quot;
		14 |   filename         = data.archive_file.lambda_generar_informes.output_path
		15 |   source_code_hash = data.archive_file.lambda_generar_informes.output_base64sha256
		16 | 
		17 |   vpc_config {
		18 |   subnet_ids         = local.lambda_config.vpc.subnet_ids
		19 |   security_group_ids = local.lambda_config.vpc.security_group_ids
		20 |   }
		21 | 
		22 |   environment {
		23 |     variables = local.lambda_config.environment
		24 |   }
		25 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_116] Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)" classname="\lambda.tf.aws_lambda_function.generar_informes" file="\lambda.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)">
Resource: aws_lambda_function.generar_informes
File: \lambda.tf: 9-25
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq

		9  | resource &quot;aws_lambda_function&quot; &quot;generar_informes&quot; {
		10 |   function_name    = &quot;generar_informes&quot;
		11 |   role             = aws_iam_role.lambda_rds_role.arn
		12 |   handler          = &quot;index.handler&quot;
		13 |   runtime          = &quot;nodejs18.x&quot;
		14 |   filename         = data.archive_file.lambda_generar_informes.output_path
		15 |   source_code_hash = data.archive_file.lambda_generar_informes.output_base64sha256
		16 | 
		17 |   vpc_config {
		18 |   subnet_ids         = local.lambda_config.vpc.subnet_ids
		19 |   security_group_ids = local.lambda_config.vpc.security_group_ids
		20 |   }
		21 | 
		22 |   environment {
		23 |     variables = local.lambda_config.environment
		24 |   }
		25 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_173] Check encryption settings for Lambda environmental variable" classname="\lambda.tf.aws_lambda_function.generar_informes" file="\lambda.tf">
			<failure type="failure" message="Check encryption settings for Lambda environmental variable">
Resource: aws_lambda_function.generar_informes
File: \lambda.tf: 9-25
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5

		9  | resource &quot;aws_lambda_function&quot; &quot;generar_informes&quot; {
		10 |   function_name    = &quot;generar_informes&quot;
		11 |   role             = aws_iam_role.lambda_rds_role.arn
		12 |   handler          = &quot;index.handler&quot;
		13 |   runtime          = &quot;nodejs18.x&quot;
		14 |   filename         = data.archive_file.lambda_generar_informes.output_path
		15 |   source_code_hash = data.archive_file.lambda_generar_informes.output_base64sha256
		16 | 
		17 |   vpc_config {
		18 |   subnet_ids         = local.lambda_config.vpc.subnet_ids
		19 |   security_group_ids = local.lambda_config.vpc.security_group_ids
		20 |   }
		21 | 
		22 |   environment {
		23 |     variables = local.lambda_config.environment
		24 |   }
		25 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_115] Ensure that AWS Lambda function is configured for function-level concurrent execution limit" classname="\lambda.tf.aws_lambda_function.generar_informes" file="\lambda.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for function-level concurrent execution limit">
Resource: aws_lambda_function.generar_informes
File: \lambda.tf: 9-25
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit

		9  | resource &quot;aws_lambda_function&quot; &quot;generar_informes&quot; {
		10 |   function_name    = &quot;generar_informes&quot;
		11 |   role             = aws_iam_role.lambda_rds_role.arn
		12 |   handler          = &quot;index.handler&quot;
		13 |   runtime          = &quot;nodejs18.x&quot;
		14 |   filename         = data.archive_file.lambda_generar_informes.output_path
		15 |   source_code_hash = data.archive_file.lambda_generar_informes.output_base64sha256
		16 | 
		17 |   vpc_config {
		18 |   subnet_ids         = local.lambda_config.vpc.subnet_ids
		19 |   security_group_ids = local.lambda_config.vpc.security_group_ids
		20 |   }
		21 | 
		22 |   environment {
		23 |     variables = local.lambda_config.environment
		24 |   }
		25 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_50] X-Ray tracing is enabled for Lambda" classname="\lambda.tf.aws_lambda_function.generar_informes" file="\lambda.tf">
			<failure type="failure" message="X-Ray tracing is enabled for Lambda">
Resource: aws_lambda_function.generar_informes
File: \lambda.tf: 9-25
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-4

		9  | resource &quot;aws_lambda_function&quot; &quot;generar_informes&quot; {
		10 |   function_name    = &quot;generar_informes&quot;
		11 |   role             = aws_iam_role.lambda_rds_role.arn
		12 |   handler          = &quot;index.handler&quot;
		13 |   runtime          = &quot;nodejs18.x&quot;
		14 |   filename         = data.archive_file.lambda_generar_informes.output_path
		15 |   source_code_hash = data.archive_file.lambda_generar_informes.output_base64sha256
		16 | 
		17 |   vpc_config {
		18 |   subnet_ids         = local.lambda_config.vpc.subnet_ids
		19 |   security_group_ids = local.lambda_config.vpc.security_group_ids
		20 |   }
		21 | 
		22 |   environment {
		23 |     variables = local.lambda_config.environment
		24 |   }
		25 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_272] Ensure AWS Lambda function is configured to validate code-signing" classname="\lambda.tf.aws_lambda_function.gestionar_pedidos" file="\lambda.tf">
			<failure type="failure" message="Ensure AWS Lambda function is configured to validate code-signing">
Resource: aws_lambda_function.gestionar_pedidos
File: \lambda.tf: 35-51
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-272

		35 | resource &quot;aws_lambda_function&quot; &quot;gestionar_pedidos&quot; {
		36 |   function_name    = &quot;gestionar_pedidos&quot;
		37 |   role             = aws_iam_role.lambda_rds_role.arn
		38 |   handler          = &quot;index.handler&quot;
		39 |   runtime          = &quot;nodejs18.x&quot;
		40 |   filename         = data.archive_file.lambda_gestionar_pedidos.output_path
		41 |   source_code_hash = data.archive_file.lambda_gestionar_pedidos.output_base64sha256
		42 | 
		43 |   vpc_config {
		44 |   subnet_ids         = local.lambda_config.vpc.subnet_ids
		45 |   security_group_ids = local.lambda_config.vpc.security_group_ids
		46 |   }
		47 | 
		48 |   environment {
		49 |     variables = local.lambda_config.environment
		50 |   }
		51 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_116] Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)" classname="\lambda.tf.aws_lambda_function.gestionar_pedidos" file="\lambda.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)">
Resource: aws_lambda_function.gestionar_pedidos
File: \lambda.tf: 35-51
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq

		35 | resource &quot;aws_lambda_function&quot; &quot;gestionar_pedidos&quot; {
		36 |   function_name    = &quot;gestionar_pedidos&quot;
		37 |   role             = aws_iam_role.lambda_rds_role.arn
		38 |   handler          = &quot;index.handler&quot;
		39 |   runtime          = &quot;nodejs18.x&quot;
		40 |   filename         = data.archive_file.lambda_gestionar_pedidos.output_path
		41 |   source_code_hash = data.archive_file.lambda_gestionar_pedidos.output_base64sha256
		42 | 
		43 |   vpc_config {
		44 |   subnet_ids         = local.lambda_config.vpc.subnet_ids
		45 |   security_group_ids = local.lambda_config.vpc.security_group_ids
		46 |   }
		47 | 
		48 |   environment {
		49 |     variables = local.lambda_config.environment
		50 |   }
		51 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_173] Check encryption settings for Lambda environmental variable" classname="\lambda.tf.aws_lambda_function.gestionar_pedidos" file="\lambda.tf">
			<failure type="failure" message="Check encryption settings for Lambda environmental variable">
Resource: aws_lambda_function.gestionar_pedidos
File: \lambda.tf: 35-51
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5

		35 | resource &quot;aws_lambda_function&quot; &quot;gestionar_pedidos&quot; {
		36 |   function_name    = &quot;gestionar_pedidos&quot;
		37 |   role             = aws_iam_role.lambda_rds_role.arn
		38 |   handler          = &quot;index.handler&quot;
		39 |   runtime          = &quot;nodejs18.x&quot;
		40 |   filename         = data.archive_file.lambda_gestionar_pedidos.output_path
		41 |   source_code_hash = data.archive_file.lambda_gestionar_pedidos.output_base64sha256
		42 | 
		43 |   vpc_config {
		44 |   subnet_ids         = local.lambda_config.vpc.subnet_ids
		45 |   security_group_ids = local.lambda_config.vpc.security_group_ids
		46 |   }
		47 | 
		48 |   environment {
		49 |     variables = local.lambda_config.environment
		50 |   }
		51 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_115] Ensure that AWS Lambda function is configured for function-level concurrent execution limit" classname="\lambda.tf.aws_lambda_function.gestionar_pedidos" file="\lambda.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for function-level concurrent execution limit">
Resource: aws_lambda_function.gestionar_pedidos
File: \lambda.tf: 35-51
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit

		35 | resource &quot;aws_lambda_function&quot; &quot;gestionar_pedidos&quot; {
		36 |   function_name    = &quot;gestionar_pedidos&quot;
		37 |   role             = aws_iam_role.lambda_rds_role.arn
		38 |   handler          = &quot;index.handler&quot;
		39 |   runtime          = &quot;nodejs18.x&quot;
		40 |   filename         = data.archive_file.lambda_gestionar_pedidos.output_path
		41 |   source_code_hash = data.archive_file.lambda_gestionar_pedidos.output_base64sha256
		42 | 
		43 |   vpc_config {
		44 |   subnet_ids         = local.lambda_config.vpc.subnet_ids
		45 |   security_group_ids = local.lambda_config.vpc.security_group_ids
		46 |   }
		47 | 
		48 |   environment {
		49 |     variables = local.lambda_config.environment
		50 |   }
		51 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_50] X-Ray tracing is enabled for Lambda" classname="\lambda.tf.aws_lambda_function.gestionar_pedidos" file="\lambda.tf">
			<failure type="failure" message="X-Ray tracing is enabled for Lambda">
Resource: aws_lambda_function.gestionar_pedidos
File: \lambda.tf: 35-51
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-4

		35 | resource &quot;aws_lambda_function&quot; &quot;gestionar_pedidos&quot; {
		36 |   function_name    = &quot;gestionar_pedidos&quot;
		37 |   role             = aws_iam_role.lambda_rds_role.arn
		38 |   handler          = &quot;index.handler&quot;
		39 |   runtime          = &quot;nodejs18.x&quot;
		40 |   filename         = data.archive_file.lambda_gestionar_pedidos.output_path
		41 |   source_code_hash = data.archive_file.lambda_gestionar_pedidos.output_base64sha256
		42 | 
		43 |   vpc_config {
		44 |   subnet_ids         = local.lambda_config.vpc.subnet_ids
		45 |   security_group_ids = local.lambda_config.vpc.security_group_ids
		46 |   }
		47 | 
		48 |   environment {
		49 |     variables = local.lambda_config.environment
		50 |   }
		51 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_272] Ensure AWS Lambda function is configured to validate code-signing" classname="\lambda.tf.aws_lambda_function.init_db" file="\lambda.tf">
			<failure type="failure" message="Ensure AWS Lambda function is configured to validate code-signing">
Resource: aws_lambda_function.init_db
File: \lambda.tf: 61-77
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-272

		61 | resource &quot;aws_lambda_function&quot; &quot;init_db&quot; {
		62 |   function_name    = &quot;init_db&quot;
		63 |   role             = aws_iam_role.lambda_rds_role.arn
		64 |   handler          = &quot;index.handler&quot;
		65 |   runtime          = &quot;nodejs18.x&quot;
		66 |   filename         = data.archive_file.lambda_init_db.output_path
		67 |   source_code_hash = data.archive_file.lambda_init_db.output_base64sha256
		68 | 
		69 |   vpc_config {
		70 |   subnet_ids         = local.lambda_config.vpc.subnet_ids
		71 |   security_group_ids = local.lambda_config.vpc.security_group_ids
		72 |   }
		73 | 
		74 |   environment {
		75 |     variables = local.lambda_config.environment
		76 |   }
		77 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_116] Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)" classname="\lambda.tf.aws_lambda_function.init_db" file="\lambda.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)">
Resource: aws_lambda_function.init_db
File: \lambda.tf: 61-77
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq

		61 | resource &quot;aws_lambda_function&quot; &quot;init_db&quot; {
		62 |   function_name    = &quot;init_db&quot;
		63 |   role             = aws_iam_role.lambda_rds_role.arn
		64 |   handler          = &quot;index.handler&quot;
		65 |   runtime          = &quot;nodejs18.x&quot;
		66 |   filename         = data.archive_file.lambda_init_db.output_path
		67 |   source_code_hash = data.archive_file.lambda_init_db.output_base64sha256
		68 | 
		69 |   vpc_config {
		70 |   subnet_ids         = local.lambda_config.vpc.subnet_ids
		71 |   security_group_ids = local.lambda_config.vpc.security_group_ids
		72 |   }
		73 | 
		74 |   environment {
		75 |     variables = local.lambda_config.environment
		76 |   }
		77 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_173] Check encryption settings for Lambda environmental variable" classname="\lambda.tf.aws_lambda_function.init_db" file="\lambda.tf">
			<failure type="failure" message="Check encryption settings for Lambda environmental variable">
Resource: aws_lambda_function.init_db
File: \lambda.tf: 61-77
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5

		61 | resource &quot;aws_lambda_function&quot; &quot;init_db&quot; {
		62 |   function_name    = &quot;init_db&quot;
		63 |   role             = aws_iam_role.lambda_rds_role.arn
		64 |   handler          = &quot;index.handler&quot;
		65 |   runtime          = &quot;nodejs18.x&quot;
		66 |   filename         = data.archive_file.lambda_init_db.output_path
		67 |   source_code_hash = data.archive_file.lambda_init_db.output_base64sha256
		68 | 
		69 |   vpc_config {
		70 |   subnet_ids         = local.lambda_config.vpc.subnet_ids
		71 |   security_group_ids = local.lambda_config.vpc.security_group_ids
		72 |   }
		73 | 
		74 |   environment {
		75 |     variables = local.lambda_config.environment
		76 |   }
		77 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_115] Ensure that AWS Lambda function is configured for function-level concurrent execution limit" classname="\lambda.tf.aws_lambda_function.init_db" file="\lambda.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for function-level concurrent execution limit">
Resource: aws_lambda_function.init_db
File: \lambda.tf: 61-77
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit

		61 | resource &quot;aws_lambda_function&quot; &quot;init_db&quot; {
		62 |   function_name    = &quot;init_db&quot;
		63 |   role             = aws_iam_role.lambda_rds_role.arn
		64 |   handler          = &quot;index.handler&quot;
		65 |   runtime          = &quot;nodejs18.x&quot;
		66 |   filename         = data.archive_file.lambda_init_db.output_path
		67 |   source_code_hash = data.archive_file.lambda_init_db.output_base64sha256
		68 | 
		69 |   vpc_config {
		70 |   subnet_ids         = local.lambda_config.vpc.subnet_ids
		71 |   security_group_ids = local.lambda_config.vpc.security_group_ids
		72 |   }
		73 | 
		74 |   environment {
		75 |     variables = local.lambda_config.environment
		76 |   }
		77 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_50] X-Ray tracing is enabled for Lambda" classname="\lambda.tf.aws_lambda_function.init_db" file="\lambda.tf">
			<failure type="failure" message="X-Ray tracing is enabled for Lambda">
Resource: aws_lambda_function.init_db
File: \lambda.tf: 61-77
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-4

		61 | resource &quot;aws_lambda_function&quot; &quot;init_db&quot; {
		62 |   function_name    = &quot;init_db&quot;
		63 |   role             = aws_iam_role.lambda_rds_role.arn
		64 |   handler          = &quot;index.handler&quot;
		65 |   runtime          = &quot;nodejs18.x&quot;
		66 |   filename         = data.archive_file.lambda_init_db.output_path
		67 |   source_code_hash = data.archive_file.lambda_init_db.output_base64sha256
		68 | 
		69 |   vpc_config {
		70 |   subnet_ids         = local.lambda_config.vpc.subnet_ids
		71 |   security_group_ids = local.lambda_config.vpc.security_group_ids
		72 |   }
		73 | 
		74 |   environment {
		75 |     variables = local.lambda_config.environment
		76 |   }
		77 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_23] Ensure every security group and rule has a description" classname="\lambda.tf.aws_security_group.lambda_sg" file="\lambda.tf">
			<failure type="failure" message="Ensure every security group and rule has a description">
Resource: aws_security_group.lambda_sg
File: \lambda.tf: 113-124
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31

		113 | resource &quot;aws_security_group&quot; &quot;lambda_sg&quot; {
		114 |   name        = &quot;lambda-to-rds&quot;
		115 |   description = &quot;Permite a Lambda acceder a RDS&quot;
		116 |   vpc_id = aws_vpc.main.id
		117 | 
		118 |   egress {
		119 |     from_port   = 0
		120 |     to_port     = 0
		121 |     protocol    = &quot;-1&quot;
		122 |     cidr_blocks = [&quot;0.0.0.0/0&quot;]
		123 |   }
		124 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_382] Ensure no security groups allow egress from 0.0.0.0:0 to port -1" classname="\lambda.tf.aws_security_group.lambda_sg" file="\lambda.tf">
			<failure type="failure" message="Ensure no security groups allow egress from 0.0.0.0:0 to port -1">
Resource: aws_security_group.lambda_sg
File: \lambda.tf: 113-124
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382

		113 | resource &quot;aws_security_group&quot; &quot;lambda_sg&quot; {
		114 |   name        = &quot;lambda-to-rds&quot;
		115 |   description = &quot;Permite a Lambda acceder a RDS&quot;
		116 |   vpc_id = aws_vpc.main.id
		117 | 
		118 |   egress {
		119 |     from_port   = 0
		120 |     to_port     = 0
		121 |     protocol    = &quot;-1&quot;
		122 |     cidr_blocks = [&quot;0.0.0.0/0&quot;]
		123 |   }
		124 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_23] Ensure every security group and rule has a description" classname="\lambda.tf.aws_security_group_rule.allow_lambda_access_rds" file="\lambda.tf">
			<failure type="failure" message="Ensure every security group and rule has a description">
Resource: aws_security_group_rule.allow_lambda_access_rds
File: \lambda.tf: 126-133
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31

		126 | resource &quot;aws_security_group_rule&quot; &quot;allow_lambda_access_rds&quot; {
		127 |   type                     = &quot;ingress&quot;
		128 |   from_port                = 5432
		129 |   to_port                  = 5432
		130 |   protocol                 = &quot;tcp&quot;
		131 |   security_group_id        = aws_security_group.rds_sg.id
		132 |   source_security_group_id = aws_security_group.lambda_sg.id
		133 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_272] Ensure AWS Lambda function is configured to validate code-signing" classname="\lambda.tf.aws_lambda_function.guardar_producto" file="\lambda.tf">
			<failure type="failure" message="Ensure AWS Lambda function is configured to validate code-signing">
Resource: aws_lambda_function.guardar_producto
File: \lambda.tf: 143-160
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-272

		143 | resource &quot;aws_lambda_function&quot; &quot;guardar_producto&quot; {
		144 |   function_name    = &quot;guardar_producto&quot;
		145 |   role             = aws_iam_role.lambda_rds_role.arn
		146 |   handler          = &quot;index.handler&quot;
		147 |   runtime          = &quot;nodejs18.x&quot;
		148 |   filename         = data.archive_file.lambda_guardar_producto.output_path
		149 |   source_code_hash = data.archive_file.lambda_guardar_producto.output_base64sha256
		150 |   timeout          = 10
		151 | 
		152 |   vpc_config {
		153 |   subnet_ids         = local.lambda_config.vpc.subnet_ids
		154 |   security_group_ids = local.lambda_config.vpc.security_group_ids
		155 |   }
		156 | 
		157 |   environment {
		158 |     variables = local.lambda_config.environment
		159 |   }
		160 | }</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_116] Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)" classname="\lambda.tf.aws_lambda_function.guardar_producto" file="\lambda.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)">
Resource: aws_lambda_function.guardar_producto
File: \lambda.tf: 143-160
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq

		143 | resource &quot;aws_lambda_function&quot; &quot;guardar_producto&quot; {
		144 |   function_name    = &quot;guardar_producto&quot;
		145 |   role             = aws_iam_role.lambda_rds_role.arn
		146 |   handler          = &quot;index.handler&quot;
		147 |   runtime          = &quot;nodejs18.x&quot;
		148 |   filename         = data.archive_file.lambda_guardar_producto.output_path
		149 |   source_code_hash = data.archive_file.lambda_guardar_producto.output_base64sha256
		150 |   timeout          = 10
		151 | 
		152 |   vpc_config {
		153 |   subnet_ids         = local.lambda_config.vpc.subnet_ids
		154 |   security_group_ids = local.lambda_config.vpc.security_group_ids
		155 |   }
		156 | 
		157 |   environment {
		158 |     variables = local.lambda_config.environment
		159 |   }
		160 | }</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_173] Check encryption settings for Lambda environmental variable" classname="\lambda.tf.aws_lambda_function.guardar_producto" file="\lambda.tf">
			<failure type="failure" message="Check encryption settings for Lambda environmental variable">
Resource: aws_lambda_function.guardar_producto
File: \lambda.tf: 143-160
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5

		143 | resource &quot;aws_lambda_function&quot; &quot;guardar_producto&quot; {
		144 |   function_name    = &quot;guardar_producto&quot;
		145 |   role             = aws_iam_role.lambda_rds_role.arn
		146 |   handler          = &quot;index.handler&quot;
		147 |   runtime          = &quot;nodejs18.x&quot;
		148 |   filename         = data.archive_file.lambda_guardar_producto.output_path
		149 |   source_code_hash = data.archive_file.lambda_guardar_producto.output_base64sha256
		150 |   timeout          = 10
		151 | 
		152 |   vpc_config {
		153 |   subnet_ids         = local.lambda_config.vpc.subnet_ids
		154 |   security_group_ids = local.lambda_config.vpc.security_group_ids
		155 |   }
		156 | 
		157 |   environment {
		158 |     variables = local.lambda_config.environment
		159 |   }
		160 | }</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_115] Ensure that AWS Lambda function is configured for function-level concurrent execution limit" classname="\lambda.tf.aws_lambda_function.guardar_producto" file="\lambda.tf">
			<failure type="failure" message="Ensure that AWS Lambda function is configured for function-level concurrent execution limit">
Resource: aws_lambda_function.guardar_producto
File: \lambda.tf: 143-160
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit

		143 | resource &quot;aws_lambda_function&quot; &quot;guardar_producto&quot; {
		144 |   function_name    = &quot;guardar_producto&quot;
		145 |   role             = aws_iam_role.lambda_rds_role.arn
		146 |   handler          = &quot;index.handler&quot;
		147 |   runtime          = &quot;nodejs18.x&quot;
		148 |   filename         = data.archive_file.lambda_guardar_producto.output_path
		149 |   source_code_hash = data.archive_file.lambda_guardar_producto.output_base64sha256
		150 |   timeout          = 10
		151 | 
		152 |   vpc_config {
		153 |   subnet_ids         = local.lambda_config.vpc.subnet_ids
		154 |   security_group_ids = local.lambda_config.vpc.security_group_ids
		155 |   }
		156 | 
		157 |   environment {
		158 |     variables = local.lambda_config.environment
		159 |   }
		160 | }</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_50] X-Ray tracing is enabled for Lambda" classname="\lambda.tf.aws_lambda_function.guardar_producto" file="\lambda.tf">
			<failure type="failure" message="X-Ray tracing is enabled for Lambda">
Resource: aws_lambda_function.guardar_producto
File: \lambda.tf: 143-160
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-4

		143 | resource &quot;aws_lambda_function&quot; &quot;guardar_producto&quot; {
		144 |   function_name    = &quot;guardar_producto&quot;
		145 |   role             = aws_iam_role.lambda_rds_role.arn
		146 |   handler          = &quot;index.handler&quot;
		147 |   runtime          = &quot;nodejs18.x&quot;
		148 |   filename         = data.archive_file.lambda_guardar_producto.output_path
		149 |   source_code_hash = data.archive_file.lambda_guardar_producto.output_base64sha256
		150 |   timeout          = 10
		151 | 
		152 |   vpc_config {
		153 |   subnet_ids         = local.lambda_config.vpc.subnet_ids
		154 |   security_group_ids = local.lambda_config.vpc.security_group_ids
		155 |   }
		156 | 
		157 |   environment {
		158 |     variables = local.lambda_config.environment
		159 |   }
		160 | }</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_129] Ensure that respective logs of Amazon Relational Database Service (Amazon RDS) are enabled" classname="\rds.tf.aws_db_instance.productos_db" file="\rds.tf">
			<failure type="failure" message="Ensure that respective logs of Amazon Relational Database Service (Amazon RDS) are enabled">
Resource: aws_db_instance.productos_db
File: \rds.tf: 1-21
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-that-respective-logs-of-amazon-relational-database-service-amazon-rds-are-enabled

		1  | resource &quot;aws_db_instance&quot; &quot;productos_db&quot; {
		2  |   allocated_storage    = local.rds_config.allocated_storage
		3  |   max_allocated_storage = local.rds_config.max_allocated_storage
		4  |   engine               = local.rds_config.engine
		5  |   engine_version       = local.rds_config.engine_version
		6  |   instance_class       = local.rds_config.instance_class
		7  |   db_name              = local.rds_config.db_name
		8  |   username             = local.rds_config.username
		9  |   password             = local.rds_config.password
		10 |   parameter_group_name = local.rds_config.parameter_group_name
		11 |   publicly_accessible  = local.rds_config.publicly_accessible
		12 |   skip_final_snapshot  = local.rds_config.skip_final_snapshot
		13 | 
		14 |   vpc_security_group_ids = [aws_security_group.rds_sg.id]
		15 |   db_subnet_group_name   = aws_db_subnet_group.rds_subnet_group.name
		16 | 
		17 |   tags = {
		18 |     Name        = &quot;ProductosDB&quot;
		19 |     Environment = &quot;dev&quot;
		20 |   }
		21 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_226] Ensure DB instance gets all minor upgrades automatically" classname="\rds.tf.aws_db_instance.productos_db" file="\rds.tf">
			<failure type="failure" message="Ensure DB instance gets all minor upgrades automatically">
Resource: aws_db_instance.productos_db
File: \rds.tf: 1-21
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-db-instance-gets-all-minor-upgrades-automatically

		1  | resource &quot;aws_db_instance&quot; &quot;productos_db&quot; {
		2  |   allocated_storage    = local.rds_config.allocated_storage
		3  |   max_allocated_storage = local.rds_config.max_allocated_storage
		4  |   engine               = local.rds_config.engine
		5  |   engine_version       = local.rds_config.engine_version
		6  |   instance_class       = local.rds_config.instance_class
		7  |   db_name              = local.rds_config.db_name
		8  |   username             = local.rds_config.username
		9  |   password             = local.rds_config.password
		10 |   parameter_group_name = local.rds_config.parameter_group_name
		11 |   publicly_accessible  = local.rds_config.publicly_accessible
		12 |   skip_final_snapshot  = local.rds_config.skip_final_snapshot
		13 | 
		14 |   vpc_security_group_ids = [aws_security_group.rds_sg.id]
		15 |   db_subnet_group_name   = aws_db_subnet_group.rds_subnet_group.name
		16 | 
		17 |   tags = {
		18 |     Name        = &quot;ProductosDB&quot;
		19 |     Environment = &quot;dev&quot;
		20 |   }
		21 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_16] Ensure all data stored in the RDS is securely encrypted at rest" classname="\rds.tf.aws_db_instance.productos_db" file="\rds.tf">
			<failure type="failure" message="Ensure all data stored in the RDS is securely encrypted at rest">
Resource: aws_db_instance.productos_db
File: \rds.tf: 1-21
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-4

		1  | resource &quot;aws_db_instance&quot; &quot;productos_db&quot; {
		2  |   allocated_storage    = local.rds_config.allocated_storage
		3  |   max_allocated_storage = local.rds_config.max_allocated_storage
		4  |   engine               = local.rds_config.engine
		5  |   engine_version       = local.rds_config.engine_version
		6  |   instance_class       = local.rds_config.instance_class
		7  |   db_name              = local.rds_config.db_name
		8  |   username             = local.rds_config.username
		9  |   password             = local.rds_config.password
		10 |   parameter_group_name = local.rds_config.parameter_group_name
		11 |   publicly_accessible  = local.rds_config.publicly_accessible
		12 |   skip_final_snapshot  = local.rds_config.skip_final_snapshot
		13 | 
		14 |   vpc_security_group_ids = [aws_security_group.rds_sg.id]
		15 |   db_subnet_group_name   = aws_db_subnet_group.rds_subnet_group.name
		16 | 
		17 |   tags = {
		18 |     Name        = &quot;ProductosDB&quot;
		19 |     Environment = &quot;dev&quot;
		20 |   }
		21 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_118] Ensure that enhanced monitoring is enabled for Amazon RDS instances" classname="\rds.tf.aws_db_instance.productos_db" file="\rds.tf">
			<failure type="failure" message="Ensure that enhanced monitoring is enabled for Amazon RDS instances">
Resource: aws_db_instance.productos_db
File: \rds.tf: 1-21
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/ensure-that-enhanced-monitoring-is-enabled-for-amazon-rds-instances

		1  | resource &quot;aws_db_instance&quot; &quot;productos_db&quot; {
		2  |   allocated_storage    = local.rds_config.allocated_storage
		3  |   max_allocated_storage = local.rds_config.max_allocated_storage
		4  |   engine               = local.rds_config.engine
		5  |   engine_version       = local.rds_config.engine_version
		6  |   instance_class       = local.rds_config.instance_class
		7  |   db_name              = local.rds_config.db_name
		8  |   username             = local.rds_config.username
		9  |   password             = local.rds_config.password
		10 |   parameter_group_name = local.rds_config.parameter_group_name
		11 |   publicly_accessible  = local.rds_config.publicly_accessible
		12 |   skip_final_snapshot  = local.rds_config.skip_final_snapshot
		13 | 
		14 |   vpc_security_group_ids = [aws_security_group.rds_sg.id]
		15 |   db_subnet_group_name   = aws_db_subnet_group.rds_subnet_group.name
		16 | 
		17 |   tags = {
		18 |     Name        = &quot;ProductosDB&quot;
		19 |     Environment = &quot;dev&quot;
		20 |   }
		21 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_293] Ensure that AWS database instances have deletion protection enabled" classname="\rds.tf.aws_db_instance.productos_db" file="\rds.tf">
			<failure type="failure" message="Ensure that AWS database instances have deletion protection enabled">
Resource: aws_db_instance.productos_db
File: \rds.tf: 1-21
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-293

		1  | resource &quot;aws_db_instance&quot; &quot;productos_db&quot; {
		2  |   allocated_storage    = local.rds_config.allocated_storage
		3  |   max_allocated_storage = local.rds_config.max_allocated_storage
		4  |   engine               = local.rds_config.engine
		5  |   engine_version       = local.rds_config.engine_version
		6  |   instance_class       = local.rds_config.instance_class
		7  |   db_name              = local.rds_config.db_name
		8  |   username             = local.rds_config.username
		9  |   password             = local.rds_config.password
		10 |   parameter_group_name = local.rds_config.parameter_group_name
		11 |   publicly_accessible  = local.rds_config.publicly_accessible
		12 |   skip_final_snapshot  = local.rds_config.skip_final_snapshot
		13 | 
		14 |   vpc_security_group_ids = [aws_security_group.rds_sg.id]
		15 |   db_subnet_group_name   = aws_db_subnet_group.rds_subnet_group.name
		16 | 
		17 |   tags = {
		18 |     Name        = &quot;ProductosDB&quot;
		19 |     Environment = &quot;dev&quot;
		20 |   }
		21 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_353] Ensure that RDS instances have performance insights enabled" classname="\rds.tf.aws_db_instance.productos_db" file="\rds.tf">
			<failure type="failure" message="Ensure that RDS instances have performance insights enabled">
Resource: aws_db_instance.productos_db
File: \rds.tf: 1-21
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-353

		1  | resource &quot;aws_db_instance&quot; &quot;productos_db&quot; {
		2  |   allocated_storage    = local.rds_config.allocated_storage
		3  |   max_allocated_storage = local.rds_config.max_allocated_storage
		4  |   engine               = local.rds_config.engine
		5  |   engine_version       = local.rds_config.engine_version
		6  |   instance_class       = local.rds_config.instance_class
		7  |   db_name              = local.rds_config.db_name
		8  |   username             = local.rds_config.username
		9  |   password             = local.rds_config.password
		10 |   parameter_group_name = local.rds_config.parameter_group_name
		11 |   publicly_accessible  = local.rds_config.publicly_accessible
		12 |   skip_final_snapshot  = local.rds_config.skip_final_snapshot
		13 | 
		14 |   vpc_security_group_ids = [aws_security_group.rds_sg.id]
		15 |   db_subnet_group_name   = aws_db_subnet_group.rds_subnet_group.name
		16 | 
		17 |   tags = {
		18 |     Name        = &quot;ProductosDB&quot;
		19 |     Environment = &quot;dev&quot;
		20 |   }
		21 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_157] Ensure that RDS instances have Multi-AZ enabled" classname="\rds.tf.aws_db_instance.productos_db" file="\rds.tf">
			<failure type="failure" message="Ensure that RDS instances have Multi-AZ enabled">
Resource: aws_db_instance.productos_db
File: \rds.tf: 1-21
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-73

		1  | resource &quot;aws_db_instance&quot; &quot;productos_db&quot; {
		2  |   allocated_storage    = local.rds_config.allocated_storage
		3  |   max_allocated_storage = local.rds_config.max_allocated_storage
		4  |   engine               = local.rds_config.engine
		5  |   engine_version       = local.rds_config.engine_version
		6  |   instance_class       = local.rds_config.instance_class
		7  |   db_name              = local.rds_config.db_name
		8  |   username             = local.rds_config.username
		9  |   password             = local.rds_config.password
		10 |   parameter_group_name = local.rds_config.parameter_group_name
		11 |   publicly_accessible  = local.rds_config.publicly_accessible
		12 |   skip_final_snapshot  = local.rds_config.skip_final_snapshot
		13 | 
		14 |   vpc_security_group_ids = [aws_security_group.rds_sg.id]
		15 |   db_subnet_group_name   = aws_db_subnet_group.rds_subnet_group.name
		16 | 
		17 |   tags = {
		18 |     Name        = &quot;ProductosDB&quot;
		19 |     Environment = &quot;dev&quot;
		20 |   }
		21 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_23] Ensure every security group and rule has a description" classname="\rds.tf.aws_security_group.rds_sg" file="\rds.tf">
			<failure type="failure" message="Ensure every security group and rule has a description">
Resource: aws_security_group.rds_sg
File: \rds.tf: 23-41
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31

		23 | resource &quot;aws_security_group&quot; &quot;rds_sg&quot; {
		24 |   name        = &quot;rds-sg&quot;
		25 |   description = &quot;Allow access to RDS from the application&quot;
		26 |   vpc_id      = aws_vpc.main.id
		27 | 
		28 |   ingress {
		29 |     from_port   = 5432
		30 |     to_port     = 5432
		31 |     protocol    = &quot;tcp&quot;
		32 |     cidr_blocks = [&quot;0.0.0.0/0&quot;]
		33 |   }
		34 | 
		35 |   egress {
		36 |     from_port   = 0
		37 |     to_port     = 0
		38 |     protocol    = &quot;-1&quot;
		39 |     cidr_blocks = [&quot;0.0.0.0/0&quot;]
		40 |   }
		41 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_382] Ensure no security groups allow egress from 0.0.0.0:0 to port -1" classname="\rds.tf.aws_security_group.rds_sg" file="\rds.tf">
			<failure type="failure" message="Ensure no security groups allow egress from 0.0.0.0:0 to port -1">
Resource: aws_security_group.rds_sg
File: \rds.tf: 23-41
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382

		23 | resource &quot;aws_security_group&quot; &quot;rds_sg&quot; {
		24 |   name        = &quot;rds-sg&quot;
		25 |   description = &quot;Allow access to RDS from the application&quot;
		26 |   vpc_id      = aws_vpc.main.id
		27 | 
		28 |   ingress {
		29 |     from_port   = 5432
		30 |     to_port     = 5432
		31 |     protocol    = &quot;tcp&quot;
		32 |     cidr_blocks = [&quot;0.0.0.0/0&quot;]
		33 |   }
		34 | 
		35 |   egress {
		36 |     from_port   = 0
		37 |     to_port     = 0
		38 |     protocol    = &quot;-1&quot;
		39 |     cidr_blocks = [&quot;0.0.0.0/0&quot;]
		40 |   }
		41 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_53] Ensure S3 bucket has block public ACLS enabled" classname="\s3.tf.aws_s3_bucket_public_access_block.frontend_block" file="\s3.tf">
			<failure type="failure" message="Ensure S3 bucket has block public ACLS enabled">
Resource: aws_s3_bucket_public_access_block.frontend_block
File: \s3.tf: 34-40
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-19

		34 | resource &quot;aws_s3_bucket_public_access_block&quot; &quot;frontend_block&quot; {
		35 |   bucket                  = aws_s3_bucket.frontend.id
		36 |   block_public_acls       = false
		37 |   block_public_policy     = false
		38 |   restrict_public_buckets = false
		39 |   ignore_public_acls      = false
		40 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_54] Ensure S3 bucket has block public policy enabled" classname="\s3.tf.aws_s3_bucket_public_access_block.frontend_block" file="\s3.tf">
			<failure type="failure" message="Ensure S3 bucket has block public policy enabled">
Resource: aws_s3_bucket_public_access_block.frontend_block
File: \s3.tf: 34-40
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-20

		34 | resource &quot;aws_s3_bucket_public_access_block&quot; &quot;frontend_block&quot; {
		35 |   bucket                  = aws_s3_bucket.frontend.id
		36 |   block_public_acls       = false
		37 |   block_public_policy     = false
		38 |   restrict_public_buckets = false
		39 |   ignore_public_acls      = false
		40 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_55] Ensure S3 bucket has ignore public ACLs enabled" classname="\s3.tf.aws_s3_bucket_public_access_block.frontend_block" file="\s3.tf">
			<failure type="failure" message="Ensure S3 bucket has ignore public ACLs enabled">
Resource: aws_s3_bucket_public_access_block.frontend_block
File: \s3.tf: 34-40
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-21

		34 | resource &quot;aws_s3_bucket_public_access_block&quot; &quot;frontend_block&quot; {
		35 |   bucket                  = aws_s3_bucket.frontend.id
		36 |   block_public_acls       = false
		37 |   block_public_policy     = false
		38 |   restrict_public_buckets = false
		39 |   ignore_public_acls      = false
		40 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_56] Ensure S3 bucket has 'restrict_public_buckets' enabled" classname="\s3.tf.aws_s3_bucket_public_access_block.frontend_block" file="\s3.tf">
			<failure type="failure" message="Ensure S3 bucket has 'restrict_public_buckets' enabled">
Resource: aws_s3_bucket_public_access_block.frontend_block
File: \s3.tf: 34-40
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-22

		34 | resource &quot;aws_s3_bucket_public_access_block&quot; &quot;frontend_block&quot; {
		35 |   bucket                  = aws_s3_bucket.frontend.id
		36 |   block_public_acls       = false
		37 |   block_public_policy     = false
		38 |   restrict_public_buckets = false
		39 |   ignore_public_acls      = false
		40 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_70] Ensure S3 bucket does not allow an action with any Principal" classname="\s3.tf.aws_s3_bucket_policy.allow_public_read" file="\s3.tf">
			<failure type="failure" message="Ensure S3 bucket does not allow an action with any Principal">
Resource: aws_s3_bucket_policy.allow_public_read
File: \s3.tf: 54-71
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-23

		54 | resource &quot;aws_s3_bucket_policy&quot; &quot;allow_public_read&quot; {
		55 |   bucket = aws_s3_bucket.frontend.id
		56 | 
		57 |   depends_on = [aws_s3_bucket_public_access_block.frontend_block]
		58 | 
		59 |   policy = jsonencode({
		60 |     Version = &quot;2012-10-17&quot;,
		61 |     Statement = [
		62 |       {
		63 |         Sid       = &quot;PublicReadGetObject&quot;,
		64 |         Effect    = &quot;Allow&quot;,
		65 |         Principal = &quot;*&quot;,
		66 |         Action    = [&quot;s3:GetObject&quot;],
		67 |         Resource  = &quot;${aws_s3_bucket.frontend.arn}/*&quot;
		68 |       }
		69 |     ]
		70 |   })
		71 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_4] Ensure API Gateway stage have logging level defined as appropriate" classname="\apigateway.tf.aws_api_gateway_stage.prod" file="\apigateway.tf">
			<failure type="failure" message="Ensure API Gateway stage have logging level defined as appropriate">
Resource: aws_api_gateway_stage.prod
File: \apigateway.tf: 19-39
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/ensure-api-gateway-stage-have-logging-level-defined-as-appropiate

		19 | resource &quot;aws_api_gateway_stage&quot; &quot;prod&quot; {
		20 |   deployment_id = aws_api_gateway_deployment.deploy.id
		21 |   rest_api_id   = aws_api_gateway_rest_api.productos_api.id
		22 |   stage_name    = &quot;prod&quot;
		23 | 
		24 |   access_log_settings {
		25 |     destination_arn = aws_cloudwatch_log_group.api_gateway_logs.arn
		26 |     format = jsonencode({
		27 |       requestId      = &quot;$context.requestId&quot;
		28 |       ip             = &quot;$context.identity.sourceIp&quot;
		29 |       caller         = &quot;$context.identity.caller&quot;
		30 |       user           = &quot;$context.identity.user&quot;
		31 |       requestTime    = &quot;$context.requestTime&quot;
		32 |       httpMethod     = &quot;$context.httpMethod&quot;
		33 |       resourcePath   = &quot;$context.resourcePath&quot;
		34 |       status         = &quot;$context.status&quot;
		35 |       protocol       = &quot;$context.protocol&quot;
		36 |       responseLength = &quot;$context.responseLength&quot;
		37 |     })
		38 |   }
		39 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_42] Ensure AWS CloudFront distribution uses custom SSL certificate" classname="\cloudfront.tf.aws_cloudfront_distribution.frontend_cdn" file="\cloudfront.tf">
			<failure type="failure" message="Ensure AWS CloudFront distribution uses custom SSL certificate">
Resource: aws_cloudfront_distribution.frontend_cdn
File: \cloudfront.tf: 1-40
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-cloudfront-distribution-uses-custom-ssl-certificate

		1  | resource &quot;aws_cloudfront_distribution&quot; &quot;frontend_cdn&quot; {
		2  |   origin {
		3  |     domain_name = aws_s3_bucket_website_configuration.frontend_website.website_endpoint
		4  |     origin_id   = &quot;frontendS3&quot;
		5  | 
		6  |     custom_origin_config {
		7  |       http_port              = 80
		8  |       https_port             = 443
		9  |       origin_protocol_policy = &quot;http-only&quot;
		10 |       origin_ssl_protocols   = [&quot;TLSv1.2&quot;]
		11 |     }
		12 |   }
		13 | 
		14 |   enabled             = true
		15 |   default_root_object = &quot;index.html&quot;
		16 | 
		17 |   default_cache_behavior {
		18 |     viewer_protocol_policy = &quot;redirect-to-https&quot;
		19 |     allowed_methods        = [&quot;GET&quot;, &quot;HEAD&quot;]
		20 |     cached_methods         = [&quot;GET&quot;, &quot;HEAD&quot;]
		21 | 
		22 |     target_origin_id = &quot;frontendS3&quot;
		23 |     forwarded_values {
		24 |       query_string = false
		25 |       cookies {
		26 |         forward = &quot;none&quot;
		27 |       }
		28 |     }
		29 |   }
		30 | 
		31 |   restrictions {
		32 |     geo_restriction {
		33 |       restriction_type = &quot;none&quot;
		34 |     }
		35 |   }
		36 | 
		37 |   viewer_certificate {
		38 |     cloudfront_default_certificate = true
		39 |   }
		40 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_32] Ensure CloudFront distribution has a response headers policy attached" classname="\cloudfront.tf.aws_cloudfront_distribution.frontend_cdn" file="\cloudfront.tf">
			<failure type="failure" message="Ensure CloudFront distribution has a response headers policy attached">
Resource: aws_cloudfront_distribution.frontend_cdn
File: \cloudfront.tf: 1-40
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-networking-65

		1  | resource &quot;aws_cloudfront_distribution&quot; &quot;frontend_cdn&quot; {
		2  |   origin {
		3  |     domain_name = aws_s3_bucket_website_configuration.frontend_website.website_endpoint
		4  |     origin_id   = &quot;frontendS3&quot;
		5  | 
		6  |     custom_origin_config {
		7  |       http_port              = 80
		8  |       https_port             = 443
		9  |       origin_protocol_policy = &quot;http-only&quot;
		10 |       origin_ssl_protocols   = [&quot;TLSv1.2&quot;]
		11 |     }
		12 |   }
		13 | 
		14 |   enabled             = true
		15 |   default_root_object = &quot;index.html&quot;
		16 | 
		17 |   default_cache_behavior {
		18 |     viewer_protocol_policy = &quot;redirect-to-https&quot;
		19 |     allowed_methods        = [&quot;GET&quot;, &quot;HEAD&quot;]
		20 |     cached_methods         = [&quot;GET&quot;, &quot;HEAD&quot;]
		21 | 
		22 |     target_origin_id = &quot;frontendS3&quot;
		23 |     forwarded_values {
		24 |       query_string = false
		25 |       cookies {
		26 |         forward = &quot;none&quot;
		27 |       }
		28 |     }
		29 |   }
		30 | 
		31 |   restrictions {
		32 |     geo_restriction {
		33 |       restriction_type = &quot;none&quot;
		34 |     }
		35 |   }
		36 | 
		37 |   viewer_certificate {
		38 |     cloudfront_default_certificate = true
		39 |   }
		40 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_47] Ensure AWS CloudFront attached WAFv2 WebACL is configured with AMR for Log4j Vulnerability" classname="\cloudfront.tf.aws_cloudfront_distribution.frontend_cdn" file="\cloudfront.tf">
			<failure type="failure" message="Ensure AWS CloudFront attached WAFv2 WebACL is configured with AMR for Log4j Vulnerability">
Resource: aws_cloudfront_distribution.frontend_cdn
File: \cloudfront.tf: 1-40
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-47

		1  | resource &quot;aws_cloudfront_distribution&quot; &quot;frontend_cdn&quot; {
		2  |   origin {
		3  |     domain_name = aws_s3_bucket_website_configuration.frontend_website.website_endpoint
		4  |     origin_id   = &quot;frontendS3&quot;
		5  | 
		6  |     custom_origin_config {
		7  |       http_port              = 80
		8  |       https_port             = 443
		9  |       origin_protocol_policy = &quot;http-only&quot;
		10 |       origin_ssl_protocols   = [&quot;TLSv1.2&quot;]
		11 |     }
		12 |   }
		13 | 
		14 |   enabled             = true
		15 |   default_root_object = &quot;index.html&quot;
		16 | 
		17 |   default_cache_behavior {
		18 |     viewer_protocol_policy = &quot;redirect-to-https&quot;
		19 |     allowed_methods        = [&quot;GET&quot;, &quot;HEAD&quot;]
		20 |     cached_methods         = [&quot;GET&quot;, &quot;HEAD&quot;]
		21 | 
		22 |     target_origin_id = &quot;frontendS3&quot;
		23 |     forwarded_values {
		24 |       query_string = false
		25 |       cookies {
		26 |         forward = &quot;none&quot;
		27 |       }
		28 |     }
		29 |   }
		30 | 
		31 |   restrictions {
		32 |     geo_restriction {
		33 |       restriction_type = &quot;none&quot;
		34 |     }
		35 |   }
		36 | 
		37 |   viewer_certificate {
		38 |     cloudfront_default_certificate = true
		39 |   }
		40 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_30] Ensure Postgres RDS as aws_db_instance has Query Logging enabled" classname="\rds.tf.aws_db_instance.productos_db" file="\rds.tf">
			<failure type="failure" message="Ensure Postgres RDS as aws_db_instance has Query Logging enabled">
Resource: aws_db_instance.productos_db
File: \rds.tf: 1-21
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-postgres-rds-has-query-logging-enabled

		1  | resource &quot;aws_db_instance&quot; &quot;productos_db&quot; {
		2  |   allocated_storage    = local.rds_config.allocated_storage
		3  |   max_allocated_storage = local.rds_config.max_allocated_storage
		4  |   engine               = local.rds_config.engine
		5  |   engine_version       = local.rds_config.engine_version
		6  |   instance_class       = local.rds_config.instance_class
		7  |   db_name              = local.rds_config.db_name
		8  |   username             = local.rds_config.username
		9  |   password             = local.rds_config.password
		10 |   parameter_group_name = local.rds_config.parameter_group_name
		11 |   publicly_accessible  = local.rds_config.publicly_accessible
		12 |   skip_final_snapshot  = local.rds_config.skip_final_snapshot
		13 | 
		14 |   vpc_security_group_ids = [aws_security_group.rds_sg.id]
		15 |   db_subnet_group_name   = aws_db_subnet_group.rds_subnet_group.name
		16 | 
		17 |   tags = {
		18 |     Name        = &quot;ProductosDB&quot;
		19 |     Environment = &quot;dev&quot;
		20 |   }
		21 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_60] Ensure RDS instance with copy tags to snapshots is enabled" classname="\rds.tf.aws_db_instance.productos_db" file="\rds.tf">
			<failure type="failure" message="Ensure RDS instance with copy tags to snapshots is enabled">
Resource: aws_db_instance.productos_db
File: \rds.tf: 1-21
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-60

		1  | resource &quot;aws_db_instance&quot; &quot;productos_db&quot; {
		2  |   allocated_storage    = local.rds_config.allocated_storage
		3  |   max_allocated_storage = local.rds_config.max_allocated_storage
		4  |   engine               = local.rds_config.engine
		5  |   engine_version       = local.rds_config.engine_version
		6  |   instance_class       = local.rds_config.instance_class
		7  |   db_name              = local.rds_config.db_name
		8  |   username             = local.rds_config.username
		9  |   password             = local.rds_config.password
		10 |   parameter_group_name = local.rds_config.parameter_group_name
		11 |   publicly_accessible  = local.rds_config.publicly_accessible
		12 |   skip_final_snapshot  = local.rds_config.skip_final_snapshot
		13 | 
		14 |   vpc_security_group_ids = [aws_security_group.rds_sg.id]
		15 |   db_subnet_group_name   = aws_db_subnet_group.rds_subnet_group.name
		16 | 
		17 |   tags = {
		18 |     Name        = &quot;ProductosDB&quot;
		19 |     Environment = &quot;dev&quot;
		20 |   }
		21 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_51] Ensure AWS API Gateway endpoints uses client certificate authentication" classname="\apigateway.tf.aws_api_gateway_stage.prod" file="\apigateway.tf">
			<failure type="failure" message="Ensure AWS API Gateway endpoints uses client certificate authentication">
Resource: aws_api_gateway_stage.prod
File: \apigateway.tf: 19-39
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-51

		19 | resource &quot;aws_api_gateway_stage&quot; &quot;prod&quot; {
		20 |   deployment_id = aws_api_gateway_deployment.deploy.id
		21 |   rest_api_id   = aws_api_gateway_rest_api.productos_api.id
		22 |   stage_name    = &quot;prod&quot;
		23 | 
		24 |   access_log_settings {
		25 |     destination_arn = aws_cloudwatch_log_group.api_gateway_logs.arn
		26 |     format = jsonencode({
		27 |       requestId      = &quot;$context.requestId&quot;
		28 |       ip             = &quot;$context.identity.sourceIp&quot;
		29 |       caller         = &quot;$context.identity.caller&quot;
		30 |       user           = &quot;$context.identity.user&quot;
		31 |       requestTime    = &quot;$context.requestTime&quot;
		32 |       httpMethod     = &quot;$context.httpMethod&quot;
		33 |       resourcePath   = &quot;$context.resourcePath&quot;
		34 |       status         = &quot;$context.status&quot;
		35 |       protocol       = &quot;$context.protocol&quot;
		36 |       responseLength = &quot;$context.responseLength&quot;
		37 |     })
		38 |   }
		39 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_64] Ensure KMS key Policy is defined" classname="\cloudwatch_trigger.tf.aws_kms_key.logs_key" file="\cloudwatch_trigger.tf">
			<failure type="failure" message="Ensure KMS key Policy is defined">
Resource: aws_kms_key.logs_key
File: \cloudwatch_trigger.tf: 20-22
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-64

		20 | resource &quot;aws_kms_key&quot; &quot;logs_key&quot; {
		21 |   description = &quot;KMS key for CloudWatch log group encryption&quot;
		22 | }</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_62] Ensure S3 buckets should have event notifications enabled" classname="\s3.tf.aws_s3_bucket.frontend" file="\s3.tf">
			<failure type="failure" message="Ensure S3 buckets should have event notifications enabled">
Resource: aws_s3_bucket.frontend
File: \s3.tf: 29-32
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62

		29 | resource &quot;aws_s3_bucket&quot; &quot;frontend&quot; {
		30 |   bucket         = &quot;minimarket-frontend-charlie&quot;
		31 |   force_destroy  = true
		32 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_11] Ensure VPC flow logging is enabled in all VPCs" classname="\vpc.tf.aws_vpc.main" file="\vpc.tf">
			<failure type="failure" message="Ensure VPC flow logging is enabled in all VPCs">
Resource: aws_vpc.main
File: \vpc.tf: 1-3
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-9-enable-vpc-flow-logging

		1 | resource &quot;aws_vpc&quot; &quot;main&quot; {
		2 |   cidr_block = &quot;10.0.0.0/16&quot;
		3 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_12] Ensure the default security group of every VPC restricts all traffic" classname="\vpc.tf.aws_vpc.main" file="\vpc.tf">
			<failure type="failure" message="Ensure the default security group of every VPC restricts all traffic">
Resource: aws_vpc.main
File: \vpc.tf: 1-3
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-4

		1 | resource &quot;aws_vpc&quot; &quot;main&quot; {
		2 |   cidr_block = &quot;10.0.0.0/16&quot;
		3 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_145] Ensure that S3 buckets are encrypted with KMS by default" classname="\s3.tf.aws_s3_bucket.frontend" file="\s3.tf">
			<failure type="failure" message="Ensure that S3 buckets are encrypted with KMS by default">
Resource: aws_s3_bucket.frontend
File: \s3.tf: 29-32
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default

		29 | resource &quot;aws_s3_bucket&quot; &quot;frontend&quot; {
		30 |   bucket         = &quot;minimarket-frontend-charlie&quot;
		31 |   force_destroy  = true
		32 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_61] Ensure that an S3 bucket has a lifecycle configuration" classname="\s3.tf.aws_s3_bucket.frontend" file="\s3.tf">
			<failure type="failure" message="Ensure that an S3 bucket has a lifecycle configuration">
Resource: aws_s3_bucket.frontend
File: \s3.tf: 29-32
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61

		29 | resource &quot;aws_s3_bucket&quot; &quot;frontend&quot; {
		30 |   bucket         = &quot;minimarket-frontend-charlie&quot;
		31 |   force_destroy  = true
		32 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_18] Ensure the S3 bucket has access logging enabled" classname="\s3.tf.aws_s3_bucket.frontend" file="\s3.tf">
			<failure type="failure" message="Ensure the S3 bucket has access logging enabled">
Resource: aws_s3_bucket.frontend
File: \s3.tf: 29-32
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging

		29 | resource &quot;aws_s3_bucket&quot; &quot;frontend&quot; {
		30 |   bucket         = &quot;minimarket-frontend-charlie&quot;
		31 |   force_destroy  = true
		32 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_29] Ensure public API gateway are protected by WAF" classname="\apigateway.tf.aws_api_gateway_stage.prod" file="\apigateway.tf">
			<failure type="failure" message="Ensure public API gateway are protected by WAF">
Resource: aws_api_gateway_stage.prod
File: \apigateway.tf: 19-39
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-public-api-gateway-are-protected-by-waf

		19 | resource &quot;aws_api_gateway_stage&quot; &quot;prod&quot; {
		20 |   deployment_id = aws_api_gateway_deployment.deploy.id
		21 |   rest_api_id   = aws_api_gateway_rest_api.productos_api.id
		22 |   stage_name    = &quot;prod&quot;
		23 | 
		24 |   access_log_settings {
		25 |     destination_arn = aws_cloudwatch_log_group.api_gateway_logs.arn
		26 |     format = jsonencode({
		27 |       requestId      = &quot;$context.requestId&quot;
		28 |       ip             = &quot;$context.identity.sourceIp&quot;
		29 |       caller         = &quot;$context.identity.caller&quot;
		30 |       user           = &quot;$context.identity.user&quot;
		31 |       requestTime    = &quot;$context.requestTime&quot;
		32 |       httpMethod     = &quot;$context.httpMethod&quot;
		33 |       resourcePath   = &quot;$context.resourcePath&quot;
		34 |       status         = &quot;$context.status&quot;
		35 |       protocol       = &quot;$context.protocol&quot;
		36 |       responseLength = &quot;$context.responseLength&quot;
		37 |     })
		38 |   }
		39 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_144] Ensure that S3 bucket has cross-region replication enabled" classname="\s3.tf.aws_s3_bucket.frontend" file="\s3.tf">
			<failure type="failure" message="Ensure that S3 bucket has cross-region replication enabled">
Resource: aws_s3_bucket.frontend
File: \s3.tf: 29-32
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled

		29 | resource &quot;aws_s3_bucket&quot; &quot;frontend&quot; {
		30 |   bucket         = &quot;minimarket-frontend-charlie&quot;
		31 |   force_destroy  = true
		32 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_21] Ensure all data stored in the S3 bucket have versioning enabled" classname="\s3.tf.aws_s3_bucket.frontend" file="\s3.tf">
			<failure type="failure" message="Ensure all data stored in the S3 bucket have versioning enabled">
Resource: aws_s3_bucket.frontend
File: \s3.tf: 29-32
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning

		29 | resource &quot;aws_s3_bucket&quot; &quot;frontend&quot; {
		30 |   bucket         = &quot;minimarket-frontend-charlie&quot;
		31 |   force_destroy  = true
		32 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_6] Ensure that S3 bucket has a Public Access block" classname="\s3.tf.aws_s3_bucket.frontend" file="\s3.tf">
			<failure type="failure" message="Ensure that S3 bucket has a Public Access block">
Resource: aws_s3_bucket.frontend
File: \s3.tf: 29-32
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached

		29 | resource &quot;aws_s3_bucket&quot; &quot;frontend&quot; {
		30 |   bucket         = &quot;minimarket-frontend-charlie&quot;
		31 |   force_destroy  = true
		32 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_53] Ensure AWS API gateway request is validated" classname="\apigateway.tf.aws_api_gateway_method.method" file="\apigateway.tf">
			<failure type="failure" message="Ensure AWS API gateway request is validated">
Resource: aws_api_gateway_method.method
File: \apigateway.tf: 128-134
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-53

		128 | resource &quot;aws_api_gateway_method&quot; &quot;method&quot; {
		129 |   for_each    = { for k, v in local.resources : k =&gt; v if length(v.methods) &gt; 0 }
		130 |   rest_api_id = aws_api_gateway_rest_api.productos_api.id
		131 |   resource_id = aws_api_gateway_resource.resource[each.key].id
		132 |   http_method = each.value.methods[0]
		133 |   authorization = &quot;NONE&quot;
		134 | }
</failure>
		</testcase>
	</testsuite>
</testsuites>
